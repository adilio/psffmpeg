# PSFFmpeg Documentation

This directory contains the documentation for the PSFFmpeg PowerShell module, structured according to PowerShell best practices using **platyPS**.

## Directory Structure

```
docs/
├── README.md                          # This file
├── en-US/                             # English (US) documentation
│   ├── about/                         # About help topics (conceptual help)
│   │   ├── about_PSFFmpeg.md         # Module overview and getting started
│   │   └── about_PSFFmpeg_Examples.md # Comprehensive examples
│   └── cmdlets/                       # Individual cmdlet documentation (auto-generated)
│       ├── Convert-Media.md
│       ├── Get-MediaInfo.md
│       └── ... (one file per cmdlet)
```

## Documentation Files

### About Topics (`docs/en-US/about/`)

About topics provide conceptual help and overview information:

- **about_PSFFmpeg.md** - Module overview, prerequisites, installation, getting started, and best practices
- **about_PSFFmpeg_Examples.md** - Comprehensive usage examples from basic to advanced scenarios

These files are **manually maintained** and should be updated when:
- New features are added
- Best practices change
- Major usage patterns emerge

### Cmdlet Documentation (`docs/en-US/cmdlets/`)

Individual markdown files for each cmdlet, **automatically generated** from comment-based help using platyPS.

These files are generated by running:
```powershell
.\Build-Documentation.ps1 -GenerateMarkdown
```

You can edit these files to:
- Add additional examples
- Improve descriptions
- Add notes or tips
- Update links

After editing, regenerate the MAML files:
```powershell
.\Build-Documentation.ps1 -GenerateMAML
```

## MAML Help Files (`PSFFmpeg/en-US/`)

The `PSFFmpeg/en-US/` directory contains **external XML help files** in MAML (Microsoft Assistance Markup Language) format:

- **PSFFmpeg-help.xml** - Compiled help for all cmdlets
- **about_*.help.txt** - Compiled about topics (if applicable)

These files enable:
- `Get-Help` to work without importing the module
- `Update-Help` to download updated help
- `Save-Help` to save help for offline use
- Faster help loading

MAML files are **automatically generated** from the markdown documentation.

## Building Documentation

### Prerequisites

Install the platyPS module:
```powershell
Install-Module -Name platyPS -Scope CurrentUser
```

### Build Commands

The `Build-Documentation.ps1` script provides several options:

```powershell
# Build everything (markdown + MAML + about topics)
.\Build-Documentation.ps1 -All

# Generate only markdown cmdlet documentation
.\Build-Documentation.ps1 -GenerateMarkdown

# Generate only MAML help files
.\Build-Documentation.ps1 -GenerateMAML

# Update about topics (verify existence)
.\Build-Documentation.ps1 -UpdateAboutTopics

# Skip platyPS installation check
.\Build-Documentation.ps1 -All -SkipInstall
```

### Build Process

1. **Import platyPS** - Loads the platyPS module
2. **Import PSFFmpeg** - Loads the module to read comment-based help
3. **Generate Markdown** - Creates/updates markdown files from comment-based help
4. **Generate MAML** - Compiles markdown to XML help files
5. **Verify** - Checks that all files were created successfully

### Automated Builds

Documentation is automatically built by GitHub Actions on:
- Push to `main` branch (when module or docs change)
- Pull requests to `main` branch
- Manual workflow dispatch

See `.github/workflows/build-docs.yml` for details.

## Documentation Workflow

### For New Cmdlets

1. **Add comment-based help** to the cmdlet function:
   ```powershell
   <#
   .SYNOPSIS
       Brief description

   .DESCRIPTION
       Detailed description

   .PARAMETER ParameterName
       Parameter description

   .EXAMPLE
       Example usage

   .NOTES
       Author: PSFFmpeg Contributors
       Version: 1.0.0

   .LINK
       https://github.com/adilio/psffmpeg
   #>
   ```

2. **Run the build script**:
   ```powershell
   .\Build-Documentation.ps1 -All
   ```

3. **Review generated markdown**:
   - Check `docs/en-US/cmdlets/Your-Cmdlet.md`
   - Add additional examples if needed
   - Improve descriptions

4. **Regenerate MAML**:
   ```powershell
   .\Build-Documentation.ps1 -GenerateMAML
   ```

5. **Test the help**:
   ```powershell
   Import-Module .\PSFFmpeg\PSFFmpeg.psd1 -Force
   Get-Help Your-Cmdlet -Full
   ```

### For Updating Existing Cmdlets

1. **Update comment-based help** in the cmdlet source file
2. **Regenerate documentation**:
   ```powershell
   .\Build-Documentation.ps1 -All
   ```
3. **Review and edit** the generated markdown if needed
4. **Test** with `Get-Help`

### For About Topics

1. **Edit markdown files** in `docs/en-US/about/`
2. **Regenerate MAML**:
   ```powershell
   .\Build-Documentation.ps1 -GenerateMAML
   ```
3. **Test** with:
   ```powershell
   Get-Help about_PSFFmpeg
   Get-Help about_PSFFmpeg_Examples
   ```

## PowerShell Help System Integration

### Viewing Help

```powershell
# Import the module
Import-Module PSFFmpeg

# Get help for a cmdlet
Get-Help Convert-Media

# Get detailed help with examples
Get-Help Convert-Media -Detailed

# Get full help with parameter details
Get-Help Convert-Media -Full

# Get examples only
Get-Help Convert-Media -Examples

# View about topics
Get-Help about_PSFFmpeg
Get-Help about_PSFFmpeg_Examples

# Search for help topics
Get-Help *FFmpeg*
```

### Updatable Help

Once the module is published and help files are hosted:

```powershell
# Update help from internet
Update-Help -Module PSFFmpeg

# Save help for offline use
Save-Help -Module PSFFmpeg -DestinationPath C:\Help
```

## Best Practices

### Comment-Based Help

- Include `.SYNOPSIS` - One-line description
- Include `.DESCRIPTION` - Detailed explanation
- Document all parameters with `.PARAMETER`
- Provide 2-4 examples with `.EXAMPLE`
- Add `.OUTPUTS` to specify return types
- Include `.NOTES` with author and version info
- Add `.LINK` to related cmdlets and URLs

### Markdown Documentation

- Keep examples realistic and useful
- Explain what each example demonstrates
- Use code blocks with PowerShell syntax highlighting
- Include expected output when helpful
- Link related cmdlets and topics

### About Topics

- Start with SHORT DESCRIPTION
- Provide comprehensive LONG DESCRIPTION
- Include practical examples
- Organize with clear headings
- End with SEE ALSO section
- Include KEYWORDS section

## Troubleshooting

### platyPS Not Found

```powershell
Install-Module -Name platyPS -Scope CurrentUser -Force
```

### MAML File Not Generated

1. Check that markdown files exist in `docs/en-US/cmdlets/`
2. Verify markdown syntax is valid
3. Run with verbose output:
   ```powershell
   .\Build-Documentation.ps1 -All -Verbose
   ```

### Help Not Showing

1. Reimport the module:
   ```powershell
   Import-Module .\PSFFmpeg\PSFFmpeg.psd1 -Force
   ```
2. Check MAML files exist in `PSFFmpeg/en-US/`
3. Verify HelpInfoURI in module manifest
4. Try:
   ```powershell
   Get-Help Convert-Media -Full
   ```

### GitHub Actions Build Failing

1. Check the workflow logs
2. Verify PowerShell syntax in cmdlet files
3. Test build script locally
4. Check file permissions

## Resources

- [platyPS Documentation](https://github.com/PowerShell/platyPS)
- [About Comment-Based Help](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_comment_based_help)
- [About Updatable Help](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_updatable_help)
- [PowerShell Help System](https://docs.microsoft.com/powershell/scripting/developer/help/writing-help-for-windows-powershell-modules)

## Contributing

When contributing to PSFFmpeg:

1. **Always update comment-based help** when modifying cmdlets
2. **Run the build script** before submitting PRs
3. **Include examples** in your cmdlet help
4. **Update about topics** if adding major features
5. **Test help output** with `Get-Help`

For questions or issues with documentation, please open an issue on GitHub.
